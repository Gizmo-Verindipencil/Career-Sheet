import{Buildable}from"../interface/buildable.min.js";import{CareerSheetModel}from"../model/career-sheet-model.min.js";import{Utility}from"../shared/utility.min.js";import ScriptSeriesLoader from"../shared/script-series-loader.min.js";class Constant{static get completeExecute(){return"execute"}static get completeLoadContents(){return"load_contents"}}class CareerSheetController extends Buildable{constructor(){super(),this.model=new CareerSheetModel,this.scriptLoader=ScriptSeriesLoader,this.scriptLoader.add("https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"),this.scriptLoader.add("js/vendor/season-reminder.min.js"),this.scriptLoader.load(),this.complete={},this.complete[Constant.completeExecute]=!1,this.complete[Constant.completeLoadContents]=!1,this.urls=[],this.urls.push("core-information.html"),this.urls.push("work-experience.html"),this.urls.push("qualification.html"),this.urls.push("statistics.html"),this.urls.push("supplementary.html");for(const e of this.urls)this.complete[e]=!1}static build=async()=>{const e=new CareerSheetController;for(;e.scriptLoader.running;)await Utility.sleep(2e3);return e};execute=()=>{this.appendPages(this.urls),this.changeBackgroundColor(Constant.completeExecute),$("body").addClass("loaded")};appendPages=e=>{const t=()=>{if(0===e.length)return;const s=e.shift();$.ajax({type:"GET",url:s,async:!0,success:e=>{const o=$(e);$("body").append(o),o.ready((()=>{this.changeBackgroundColor(s)})),t()}})};t()};changeBackgroundColor=e=>{this.complete[e]=!0,!this.complete[Constant.completeLoadContents]&&this.urls.every((e=>this.complete[e]))&&(this.complete[Constant.completeLoadContents]=!0);for(const e in this.complete)if(!this.complete[e])return;const t=new SeasonReminder;t.seasonInfluence=10;const s=Array.from(document.getElementsByClassName("preloader-section"));t.remindAll("background-color",s)}}export{CareerSheetController};