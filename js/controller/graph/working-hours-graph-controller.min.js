import{createInstance}from"../../keyword/create-instance.min.js";import{Buildable}from"../../interface/buildable.min.js";import{WorkingHoursGraphModel}from"../../model/graph/working-hours-graph-model.min.js";import{Threading}from"../../shared/threading.min.js";import{PageColorAdjuster}from"../../shared/page-color-adjuster.min.js";import ScriptSeriesLoader from"../../shared/script-series-loader.min.js";class WorkingHoursGraphController extends Buildable{constructor(){super(),this.model=new WorkingHoursGraphModel,this.scriptLoader=ScriptSeriesLoader,this.scriptLoader.add("https://cdn.plot.ly/plotly-latest.min.js","Plotly"),this.scriptLoader.load()}static build=async()=>{const r=new WorkingHoursGraphController;for(;r.scriptLoader.running;)await Threading.sleep(2e3);return r};execute=async()=>{const r=(r,e,o)=>({mode:"scatter",name:r,line:{color:e},x:o.map((r=>r.yearMonth)),y:o.map((r=>r.value))}),e=[r("実績(h)","rgb(255,0,0)",this.model.getActual()),r("実働移動平均(h)","rgb(255,130,130)",this.model.getActualEMA()),r("実働全体平均(h)","rgb(255,160,160)",this.model.getActualAverage()),r("計画(h)","rgb(0,0,255)",this.model.getPrescribed()),r("計画移動平均(h)","rgb(130,130,255)",this.model.getPrescribedEMA()),r("計画全体平均(h)","rgb(160,160,255)",this.model.getPrescribedAverage())];Plotly.newPlot("graph-container",e,{title:"実働/計画時間"});const o=Array.from(document.getElementsByClassName("main-svg"));(await createInstance(PageColorAdjuster)).changeBackgroundColor(o),$("body").addClass("loaded")}}export{WorkingHoursGraphController};