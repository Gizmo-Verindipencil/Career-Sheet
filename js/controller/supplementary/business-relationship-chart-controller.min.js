import{createInstance}from"../../keyword/create-instance.min.js";import{Buildable}from"../../interface/buildable.min.js";import{BusinessRelationshipChartModel}from"../../model/supplementary/business-relationship-chart-model.min.js";import{Utility}from"../../shared/utility.min.js";import{PageColorAdjuster}from"../../shared/page-color-adjuster.min.js";import ScriptSeriesLoader from"../../shared/script-series-loader.min.js";class BusinessRelationshipChartController extends Buildable{constructor(){super(),this.model=new BusinessRelationshipChartModel,this.scriptLoader=ScriptSeriesLoader,this.scriptLoader.add("https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js","JQuery"),this.scriptLoader.add("https://cdn.anychart.com/releases/8.10.0/js/anychart-bundle.min.js","anychart"),this.scriptLoader.load()}static build=async()=>{const e=new BusinessRelationshipChartController;for(;e.scriptLoader.running;)await Utility.sleep(2e3);return e};execute=async()=>{const e=new URLSearchParams(document.location.search.substring(1)).get("id"),s=this.model.getBusinessRelationshipById(e);if(!s)return void $("#chart-node-description").append("<p>NO DATA</p>");const t={nodes:s.nodes.map((e=>({id:e.id,fill:{src:`business-relationship-chart/node-image/${e.id}.svg`}}))),edges:s.edges},r=anychart.graph(t);this.setNodeDescription(s);const i=r.nodes();i.normal().height(50),i.hovered().height(60),i.hovered().fill("#ffa000"),i.hovered().stroke("#333333",2),i.selected().height(60),i.selected().fill("#ffa000"),i.selected().stroke("#333333",2),r.container("chart-container").draw();(await createInstance(PageColorAdjuster)).changeBackgroundColor(),$("body").addClass("loaded")};setNodeDescription=e=>{for(let s of e.nodes){const e=`<p style='${"float:left;padding-left:1rem;"}'>${s.id}:${s.description}</p>`;$("#chart-node-description").append(e)}}}export{BusinessRelationshipChartController};