import{ExcelDownloader}from"./excel-downloader.min.js";import{TaskCategoryRepository}from"../repository/task-category-repository.min.js";import{TaskTypeRepository}from"../repository/task-type-repository.min.js";class TaskTypeExcelDownloader{download=async()=>{const o=[];o.push(["category.id","category.name.ja","category.name.en","type.id","type.name.ja","type.name.en"]);const e=this.getTaskCategories();for(const t of e){const e=this.getTaskTypes(t.id);for(const s of e){const e=[t.id,t.name.ja,t.name.en,s.id,s.name.ja,s.name.en];o.push(e)}}const t=await ExcelDownloader.build();t.addAoaToWorkbook(o,"data"),t.download("task-type")};getTaskCategories=()=>{const o=(new TaskCategoryRepository).getAll();return o.sort(((o,e)=>o.sort>e.sort)),o};getTaskTypes=o=>{const e=(new TaskTypeRepository).getAll().filter((e=>e.categoryId===o));return e.sort(((o,e)=>o.sort>e.sort)),e}}export{TaskTypeExcelDownloader};